# GTGEN Tool 마스킹 기능 사용 가이드

## ✅ 테스트 결과

모든 마스킹 기능이 **정상적으로 구현**되어 있습니다!

- ✅ MASK->DEel (범위 삭제) 기능: 구현 완료
- ✅ Label→Mask (라벨을 마스크로 변환) 기능: 구현 완료
- ✅ 마스킹 복사 기능: 구현 완료
- ✅ 마스킹 저장/로드 기능: 구현 완료

---

## 📋 기능 사용 방법

### 1️⃣ **Label→Mask 기능** (라벨을 마스킹으로 변환)

이 기능은 선택한 라벨(바운딩 박스)을 마스킹 영역으로 변환합니다.

**사용 방법:**
1. 상단에 있는 **'Label→Mask' 체크박스를 체크**
2. **Tab 키** 또는 **화살표 키**로 변환할 라벨 선택
3. **M 키**를 누름
4. 선택한 라벨이 마스킹 영역으로 변환되고, 라벨은 삭제됨

**주의사항:**
- 체크박스를 체크하지 않으면 M 키는 일반 박스 마스킹 모드로 동작합니다
- 라벨을 먼저 선택해야 합니다 (selid >= 0)
- 변환된 마스킹은 자동으로 저장됩니다

---

### 2️⃣ **MASK->DEel 기능** (범위 삭제)

지정한 범위의 이미지와 라벨 파일을 삭제합니다.

**사용 방법:**
1. UI 하단의 **'삭제' 섹션** 찾기
2. **시작 프레임 번호** 입력 (예: 1)
3. **종료 프레임 번호** 입력 (예: 100)
4. **'실행' 버튼** 클릭
5. 확인 메시지가 표시되면 **'예'** 클릭

**주의사항:**
- 삭제 작업은 **취소할 수 없습니다**!
- 삭제 전에 자동으로 `original_backup` 폴더에 백업됩니다
- 프로그레스 바가 표시되며 삭제 진행 상황을 확인할 수 있습니다

---

### 3️⃣ **마스킹 복사 기능**

현재 저장된 마스킹을 다른 프레임들에 복사합니다.

**사용 방법:**
1. **먼저 마스킹을 생성**합니다:
   - M 키로 박스 마스킹 모드 활성화
   - 마우스 드래그로 마스킹 영역 그리기
   - **S 키**로 마스킹 저장

2. **마스킹 복사 실행**:
   - UI 하단의 **'마스킹 복사' 섹션** 찾기
   - **시작 프레임 번호** 입력 (예: 1)
   - **종료 프레임 번호** 입력 (예: 100)
   - **'실행' 버튼** 클릭

3. 확인 메시지가 표시되면 **'예'** 클릭

**주의사항:**
- 저장된 마스킹이 없으면 "저장된 마스킹이 없습니다" 경고가 표시됩니다
- 이미지 크기가 마스킹 크기와 다르면 건너뜁니다
- 'Mask→Del Labels' 옵션이 켜져 있으면 마스킹과 겹치는 라벨도 삭제됩니다

---

## 🎹 단축키 요약

| 키 | 기능 | 설명 |
|---|---|---|
| **M** | 마스킹 모드 | 박스 마스킹 또는 Label→Mask (체크박스에 따라) |
| **N** | 마우스 마스킹 | 마우스로 자유롭게 마스킹 영역 그리기 |
| **S** | 마스킹 저장 | 현재 마스킹을 메모리에 저장 |
| **L** | 마스킹 로드 | 저장된 마스킹을 현재 이미지에 적용 |
| **Tab** | 다음 라벨 선택 | Label→Mask에서 라벨 선택 시 사용 |
| **↑/↓** | 라벨 선택 | 위/아래 화살표로 라벨 선택 |

---

## 🔧 체크박스 옵션

| 옵션 | 기능 | 위치 |
|---|---|---|
| **Label→Mask** | 라벨을 마스킹으로 변환 활성화 | 상단 |
| **Mask→Del Labels** | 마스킹과 겹치는 라벨 자동 삭제 | 상단 |

---

## ❓ 문제 해결

### "기능이 동작하지 않아요"

#### Label→Mask가 동작하지 않을 때:
1. **'Label→Mask' 체크박스가 체크되어 있는지 확인**
2. 라벨이 선택되어 있는지 확인 (Tab 키로 선택)
3. M 키를 눌렀는지 확인
4. 콘솔 출력 확인: "Converting label to mask" 메시지가 나와야 함

#### MASK->DEel이 동작하지 않을 때:
1. 시작/종료 프레임 번호를 **숫자**로 입력했는지 확인
2. 프레임 범위가 유효한지 확인 (1 ~ 총 이미지 개수)
3. 시작 프레임이 종료 프레임보다 작거나 같은지 확인

#### 마스킹 복사가 동작하지 않을 때:
1. **마스킹을 먼저 생성하고 S 키로 저장**했는지 확인
2. 시작/종료 프레임 번호를 올바르게 입력했는지 확인
3. 대상 이미지의 크기가 마스킹 크기와 같은지 확인

---

## 💡 팁

1. **마스킹 작업 워크플로우:**
   ```
   마스킹 생성 (M/N 키) → 마스킹 저장 (S 키) → 마스킹 복사 (UI 버튼)
   ```

2. **Label→Mask 워크플로우:**
   ```
   체크박스 체크 → 라벨 선택 (Tab) → M 키
   ```

3. **백업 확인:**
   - 모든 작업 전에 자동으로 `original_backup` 폴더에 백업됩니다
   - 문제가 발생하면 백업에서 복원할 수 있습니다

4. **프로그레스 바:**
   - 범위 작업 시 프로그레스 바가 표시되어 진행 상황을 확인할 수 있습니다

---

## 🐛 디버깅

문제가 계속되면 콘솔 출력을 확인하세요:

```bash
# 콘솔에서 확인할 수 있는 메시지들:
- "Converting label to mask" - Label→Mask 실행됨
- "라벨→마스크: 캔버스(...) → 원본(...)" - 좌표 변환 정보
- "마스킹된 픽셀 개수: ..." - 마스킹 크기 정보
- "마스킹 정보가 메모리에 저장되었습니다" - 마스킹 저장됨
```

---

## 📞 추가 도움

- **help.txt 파일 참조**: 전체 기능 설명
- **H 키**: 프로그램 내에서 도움말 표시
- **test_masking_features.py**: 기능 테스트 스크립트 실행

---

**작성일:** 2025-11-25
**버전:** GTGEN Tool v2
